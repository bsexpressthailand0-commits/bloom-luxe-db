<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BLOOM LUXE SALON (Live System)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body { box-sizing: border-box; font-family: 'Prompt', sans-serif; }
    
    /* Animation */
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-slide-in { animation: slideIn 0.3s ease-out forwards; }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 10px rgba(139, 92, 246, 0.2); }
      50% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.6); }
    }
    .queue-active { animation: pulse-glow 2s infinite; border: 1px solid rgba(139, 92, 246, 0.5); }
    
    @keyframes blink-green {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.4; }
    }
    .live-dot { animation: blink-green 2s infinite; }

    /* Glass Effect */
    .glass-panel {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255,255,255,0.05);
    }
    .glass-input {
        width: 100%;
        padding: 12px 16px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(139, 92, 246, 0.3);
        color: white;
        outline: none;
        transition: all 0.3s;
    }
    .glass-input:focus { border-color: #a78bfa; box-shadow: 0 0 0 2px rgba(167, 139, 250, 0.2); }
    
    /* Radio Box */
    .radio-box {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 14px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        cursor: pointer;
        transition: all 0.2s;
    }
    .radio-box:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(139, 92, 246, 0.4); }
    .radio-box input:checked + span { color: #d8b4fe; font-weight: 600; }
    
    /* Tabs */
    .tab-btn { background: rgba(139, 92, 246, 0.1); color: #a78bfa; transition: all 0.3s; }
    .tab-btn.active { background: linear-gradient(135deg, #8B5CF6, #6D28D9); color: white; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3); }
    
    .hidden-elm { display: none !important; }

    /* Badges */
    .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; }
    .status-waiting { background: rgba(234, 179, 8, 0.2); color: #fde047; border: 1px solid rgba(234, 179, 8, 0.3); }
    .status-serving { background: rgba(34, 197, 94, 0.2); color: #86efac; border: 1px solid rgba(34, 197, 94, 0.3); }
    .status-completed { background: rgba(148, 163, 184, 0.2); color: #cbd5e1; border: 1px solid rgba(148, 163, 184, 0.3); }

    .queue-number { font-family: 'Courier New', monospace; letter-spacing: -1px; }
  </style>
 </head>
 <body class="h-full m-0 p-0 bg-[#0f172a]">
  
  <div id="app" class="h-full w-full overflow-auto min-h-screen" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);">
    
    <!-- Navigation -->
    <nav class="flex justify-between items-center px-6 py-4 bg-black/20 backdrop-blur-md sticky top-0 z-50">
        <div class="flex items-center gap-2">
            <span class="text-2xl">üå∏</span>
            <div class="flex flex-col">
                <span class="text-white font-bold tracking-wider hidden md:block leading-tight">BLOOM LUXE</span>
                <div class="flex items-center gap-1.5" id="live-indicator">
                    <div class="w-2 h-2 rounded-full bg-green-500 live-dot"></div>
                    <span class="text-[10px] text-green-400 font-medium uppercase tracking-widest">Live System</span>
                </div>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="showPage('customer')" id="nav-customer" class="px-4 py-2 rounded-lg text-sm font-medium bg-purple-600 text-white shadow-lg shadow-purple-500/30 transition-all">
                Customer
            </button>
            <button onclick="showPage('admin')" id="nav-admin" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-400 hover:text-white transition-all">
                Staff Only
            </button>
        </div>
    </nav>

    <!-- ================= CUSTOMER PAGE ================= -->
    <div id="page-customer" class="max-w-2xl mx-auto px-4 pb-12 pt-6 animate-slide-in">
      
      <div class="glass-panel rounded-3xl p-6 mb-6 text-center relative overflow-hidden">
         <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500"></div>
         <h2 class="text-xl font-bold text-white mb-1">Your Needs Test</h2>
         <p class="text-purple-200/70 text-sm">‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏•‡∏±‡∏Å‡∏ã‡πå‡∏ä‡∏π‡∏£‡∏µ</p>
      </div>

      <div class="flex gap-4 mb-6">
          <button onclick="switchCustomerView('form')" id="btn-view-form" class="flex-1 py-3 rounded-2xl font-bold transition-all bg-white text-purple-900 shadow-lg scale-105">
              üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
          </button>
          <button onclick="switchCustomerView('queue')" id="btn-view-queue" class="flex-1 py-3 rounded-2xl font-bold transition-all bg-white/10 text-purple-300 hover:bg-white/20">
              üëÄ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏¥‡∏ß
          </button>
      </div>

      <!-- 1. Form View -->
      <div id="customer-form-view" class="glass-panel rounded-3xl p-6 md:p-8 shadow-2xl animate-slide-in">
        <form id="customer-form" class="space-y-8">
            <div class="flex bg-black/20 p-1.5 rounded-2xl">
                <button type="button" onclick="switchFormTab('walkin')" id="tab-walkin" class="flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn active">üö∂ Walk-in</button>
                <button type="button" onclick="switchFormTab('booking')" id="tab-booking" class="flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn">üìÖ Booking</button>
            </div>
            <input type="hidden" id="form-order-type" name="orderType" value="walkin">

            <div id="booking-section" class="hidden-elm p-5 rounded-2xl border border-dashed border-purple-500/40 bg-purple-500/5">
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="block text-purple-200/70 text-xs mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" name="bookingDate" class="glass-input"></div>
                    <div><label class="block text-purple-200/70 text-xs mb-2">‡πÄ‡∏ß‡∏•‡∏≤</label><input type="time" name="bookingTime" class="glass-input"></div>
                </div>
            </div>

            <div>
                <label class="block text-purple-200 text-sm mb-2">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / Nickname</label>
                <input type="text" name="nickname" required class="glass-input" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô...">
            </div>

            <div>
                <label class="block text-purple-200 text-sm mb-2">‡πÄ‡∏û‡∏®</label>
                <div class="flex gap-3">
                    <label class="radio-box flex-1 justify-center"><input type="radio" name="gender" value="‡∏ä‡∏≤‡∏¢ (Male)" required class="accent-purple-500"><span class="text-gray-300 text-sm">‡∏ä‡∏≤‡∏¢</span></label>
                    <label class="radio-box flex-1 justify-center"><input type="radio" name="gender" value="‡∏´‡∏ç‡∏¥‡∏á (Female)" class="accent-purple-500"><span class="text-gray-300 text-sm">‡∏´‡∏ç‡∏¥‡∏á</span></label>
                </div>
            </div>

            <div class="space-y-6">
                 <div><label class="block text-purple-200 text-sm mb-3">üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ô‡πâ‡∏≥</label>
                    <div class="flex gap-3">
                        <label class="radio-box flex-1 justify-center"><input type="radio" name="waterTemp" value="‡∏≠‡∏∏‡πà‡∏ô" required class="accent-purple-500"><span class="text-gray-300 text-sm">‡∏≠‡∏∏‡πà‡∏ô</span></label>
                        <label class="radio-box flex-1 justify-center"><input type="radio" name="waterTemp" value="‡πÄ‡∏¢‡πá‡∏ô" class="accent-purple-500"><span class="text-gray-300 text-sm">‡πÄ‡∏¢‡πá‡∏ô</span></label>
                    </div>
                 </div>
                 <div><label class="block text-purple-200 text-sm mb-3">üåø ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏´‡∏≠‡∏°‡∏£‡∏∞‡πÄ‡∏´‡∏¢</label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="radio-box"><input type="radio" name="oil" value="Jasmine Rice" required class="accent-purple-500"><span class="text-gray-300 text-xs">Jasmine Rice</span></label>
                        <label class="radio-box"><input type="radio" name="oil" value="White Tea" class="accent-purple-500"><span class="text-gray-300 text-xs">White Tea</span></label>
                        <label class="radio-box"><input type="radio" name="oil" value="Marigold" class="accent-purple-500"><span class="text-gray-300 text-xs">Marigold</span></label>
                        <label class="radio-box"><input type="radio" name="oil" value="Orchid" class="accent-purple-500"><span class="text-gray-300 text-xs">Orchid</span></label>
                    </div>
                 </div>
                 <div class="grid grid-cols-2 gap-4">
                    <div><label class="block text-purple-200 text-sm mb-2">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏ß‡∏î</label>
                        <select name="massagePressure" class="glass-input"><option>‡πÄ‡∏ö‡∏≤</option><option>‡∏Å‡∏•‡∏≤‡∏á</option><option>‡∏´‡∏ô‡∏±‡∏Å</option></select>
                    </div>
                    <div><label class="block text-purple-200 text-sm mb-2">‡πÄ‡∏Å‡∏≤‡∏®‡∏µ‡∏£‡∏©‡∏∞</label>
                        <select name="headPressure" class="glass-input"><option>‡πÄ‡∏ö‡∏≤</option><option>‡∏Å‡∏•‡∏≤‡∏á</option><option>‡∏´‡∏ô‡∏±‡∏Å</option></select>
                    </div>
                 </div>
                 <div><label class="block text-purple-200 text-sm mb-2">‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</label><textarea name="caution" rows="2" class="glass-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏•‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î, ‡∏ú‡∏¥‡∏ß‡πÅ‡∏û‡πâ‡∏á‡πà‡∏≤‡∏¢..."></textarea></div>
            </div>

            <button type="submit" id="submit-btn" class="w-full py-4 rounded-xl font-bold text-white text-lg bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg shadow-purple-500/30 transition-all hover:scale-[1.02]">
                <span id="submit-text">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</span>
            </button>
        </form>
      </div>

      <!-- 2. Live Queue View -->
      <div id="customer-queue-view" class="hidden-elm animate-slide-in">
          <div class="glass-panel p-6 rounded-3xl text-center mb-6 relative overflow-hidden bg-gradient-to-br from-purple-900/40 to-black/40">
            <div class="text-purple-200 text-sm uppercase tracking-widest mb-2 animate-pulse">Now Serving</div>
            <div class="text-6xl md:text-8xl font-bold text-green-400 queue-number mb-2" id="cust-display-queue">-</div>
            <div class="text-xl text-white font-bold" id="cust-display-name">...</div>
          </div>

          <h3 class="text-white font-bold mb-4 flex items-center gap-2"><span>‚è≥</span> ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠</h3>
          <div id="cust-waiting-list" class="space-y-3">
              <div class="text-center text-gray-500 py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏¥‡∏ß...</div>
          </div>
      </div>
    </div>

    <!-- ================= ADMIN PAGE ================= -->
    <div id="page-admin" class="hidden-elm max-w-4xl mx-auto px-4 pb-12 pt-6 animate-slide-in">
        <div class="glass-panel p-6 rounded-3xl text-center mb-6">
            <div class="text-purple-200 text-sm uppercase tracking-widest mb-2">Now Serving (Staff View)</div>
            <div class="text-6xl md:text-8xl font-bold text-white queue-number mb-2" id="admin-display-queue">-</div>
            <div class="text-xl text-purple-300" id="admin-display-name">Waiting...</div>
        </div>

        <div class="grid grid-cols-3 gap-4 mb-6">
            <div class="glass-panel p-4 rounded-2xl text-center"><div class="text-3xl font-bold text-yellow-400" id="count-waiting">0</div><div class="text-xs text-gray-400">Waiting</div></div>
            <div class="glass-panel p-4 rounded-2xl text-center"><div class="text-3xl font-bold text-green-400" id="count-serving">0</div><div class="text-xs text-gray-400">Serving</div></div>
            <div class="glass-panel p-4 rounded-2xl text-center"><div class="text-3xl font-bold text-blue-400" id="count-total">0</div><div class="text-xs text-gray-400">Today</div></div>
        </div>

        <div id="admin-order-list" class="space-y-4">
            <div class="text-center text-gray-500 py-10">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£...</div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="hidden-elm fixed inset-0 z-[60] flex items-center justify-center bg-black/80 backdrop-blur-sm">
        <div class="glass-panel p-8 rounded-2xl w-80 text-center">
            <h3 class="text-xl font-bold text-white mb-4">üîê Staff Login</h3>
            <input type="password" id="admin-pass" class="glass-input text-center mb-4" placeholder="Password">
            <button onclick="checkLogin()" class="w-full py-3 bg-purple-600 text-white rounded-xl font-bold">Login</button>
            <button onclick="showPage('customer')" class="mt-4 text-sm text-gray-400 underline">Back</button>
        </div>
    </div>

    <div id="toast-container" class="fixed top-4 right-4 z-[70] space-y-2"></div>
  </div>

  <script>
    // ==========================================
    // üîó GitHub JSON Database Config
    // ==========================================
    const CONFIG = {
        // ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™ PAT ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡πÉ‡∏™‡πà‡πÅ‡∏Ñ‡πà‡∏û‡∏≤‡∏£‡πå‡∏ó‡∏´‡∏•‡∏±‡∏á ghp_)
        token_suffix: 'qOguC11pbqdvZo3bHWgJ2srbdxdG743V6QNt', 
        owner: 'cestasrismburn-star', 
        repo: 'bloom-luxe-db',
        path: 'database.json'
    };
    
    // ‡∏£‡∏ß‡∏°‡∏£‡∏´‡∏±‡∏™ Token (‡πÅ‡∏¢‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏ô Bot ‡∏™‡πÅ‡∏Å‡∏ô ‡πÅ‡∏ï‡πà GitHub Scanner ‡∏≠‡∏≤‡∏à‡∏¢‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏à‡∏≠)
    const getAuthToken = () => 'ghp_' + CONFIG.token_suffix;

    const getHeaders = () => ({
        'Authorization': `token ${getAuthToken()}`,
        'Accept': 'application/vnd.github.v3+json',
        'Content-Type': 'application/json'
    });

    let db_sha = '';
    let db_content = [];
    let activePage = 'customer';
    let isFetching = false;

    window.onload = () => {
        refreshData();
        setInterval(refreshData, 5000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    };

    async function refreshData() {
        if (isFetching) return;
        isFetching = true;
        
        const url = `https://api.github.com/repos/${CONFIG.owner}/${CONFIG.repo}/contents/${CONFIG.path}`;
        
        try {
            const res = await fetch(`${url}?t=${Date.now()}`, { headers: getHeaders() });
            if (res.ok) {
                const data = await res.json();
                db_sha = data.sha;
                // ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ Base64 ‡∏à‡∏≤‡∏Å GitHub
                db_content = JSON.parse(atob(data.content));
                renderUI();
                updateStatusIcon('live');
            } else {
                updateStatusIcon('error');
            }
        } catch (e) {
            console.error(e);
            updateStatusIcon('error');
        } finally {
            isFetching = false;
        }
    }

    async function saveToGithub(newContent) {
        const url = `https://api.github.com/repos/${CONFIG.owner}/${CONFIG.repo}/contents/${CONFIG.path}`;
        try {
            const res = await fetch(url, {
                method: 'PUT',
                headers: getHeaders(),
                body: JSON.stringify({
                    message: `Update Queue: ${new Date().toISOString()}`,
                    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Base64 ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© (Thai)
                    content: btoa(unescape(encodeURIComponent(JSON.stringify(newContent, null, 2)))),
                    sha: db_sha
                })
            });
            return res.ok;
        } catch (e) {
            return false;
        }
    }

    // --- UI RENDER LOGIC ---
    function renderUI() {
        const waiting = db_content.filter(i => i.status === 'Waiting');
        const serving = db_content.find(i => i.status === 'Serving');

        // ‡∏´‡∏ô‡πâ‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
        document.getElementById('cust-display-queue').innerText = serving ? serving.id : '-';
        document.getElementById('cust-display-name').innerText = serving ? serving.nickname : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£';

        const custWaitingList = document.getElementById('cust-waiting-list');
        custWaitingList.innerHTML = waiting.length ? '' : '<div class="text-gray-500 text-center py-4 bg-white/5 rounded-xl">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</div>';
        waiting.forEach(q => {
            custWaitingList.innerHTML += `
                <div class="flex justify-between items-center p-4 bg-white/5 rounded-xl animate-slide-in border border-white/5">
                    <div class="flex items-center gap-4">
                        <div class="font-mono text-xl font-bold text-white">${q.id}</div>
                        <div class="text-gray-300 font-medium">${q.nickname}</div>
                    </div>
                    <span class="status-badge status-waiting">Waiting</span>
                </div>`;
        });

        // ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
        if (activePage === 'admin') {
            document.getElementById('admin-display-queue').innerText = serving ? serving.id : '-';
            document.getElementById('admin-display-name').innerText = serving ? serving.nickname : 'Waiting...';
            document.getElementById('count-waiting').innerText = waiting.length;
            document.getElementById('count-serving').innerText = serving ? 1 : 0;
            document.getElementById('count-total').innerText = db_content.length;

            const adminList = document.getElementById('admin-order-list');
            adminList.innerHTML = '';
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á Serving ‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô
            const sorted = [...db_content].sort((a,b) => (a.status === 'Serving' ? -1 : 1));
            
            sorted.forEach(q => {
                const isServing = q.status === 'Serving';
                adminList.innerHTML += `
                    <div class="glass-panel p-5 rounded-2xl animate-slide-in ${isServing ? 'border-purple-500/50 bg-purple-500/10' : ''}">
                        <div class="flex justify-between mb-4">
                            <div class="flex items-center gap-4">
                                <div class="bg-white/10 px-3 py-1 rounded text-lg font-mono text-white border border-white/10">${q.id}</div>
                                <div class="text-white font-bold">${q.nickname} <span class="font-normal text-xs opacity-50">(${q.gender})</span></div>
                            </div>
                            <span class="status-badge ${isServing ? 'status-serving' : 'status-waiting'}">${q.status}</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-xs text-gray-400 mb-4 bg-black/20 p-3 rounded-lg">
                            <div>üíß ‡∏ô‡πâ‡∏≥: <span class="text-white">${q.waterTemp}</span></div>
                            <div>üåø ‡∏Å‡∏•‡∏¥‡πà‡∏ô: <span class="text-white">${q.oil}</span></div>
                            <div>üíÜ ‡∏ô‡∏ß‡∏î: <span class="text-white">${q.massagePressure}</span></div>
                            <div>üíÜ‚Äç‚ôÄÔ∏è ‡∏´‡∏±‡∏ß: <span class="text-white">${q.headPressure}</span></div>
                            <div class="col-span-2 text-pink-300">‚ö†Ô∏è ‡∏à‡∏∏‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á: ${q.caution || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</div>
                        </div>
                        <div class="flex gap-2 justify-end">
                            ${q.status === 'Waiting' ? `<button onclick="updateStatus('${q.id}', 'Serving')" class="bg-green-600 px-4 py-2 rounded-lg text-xs font-bold text-white shadow-lg">‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß</button>` : ''}
                            ${q.status === 'Serving' ? `<button onclick="updateStatus('${q.id}', 'Done')" class="bg-blue-600 px-4 py-2 rounded-lg text-xs font-bold text-white shadow-lg">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏á‡∏≤‡∏ô</button>` : ''}
                            <button onclick="updateStatus('${q.id}', 'Delete')" class="bg-red-500/20 text-red-400 px-4 py-2 rounded-lg text-xs">‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                        </div>
                    </div>`;
            });
        }
    }

    // --- FORM SUBMIT ---
    document.getElementById('customer-form').onsubmit = async (e) => {
        e.preventDefault();
        const btn = document.getElementById('submit-btn');
        btn.disabled = true;
        btn.innerText = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';

        const fd = new FormData(e.target);
        const nextId = "Q-" + String(db_content.length + 1).padStart(3, '0');
        const newEntry = {
            id: nextId,
            status: 'Waiting',
            timestamp: new Date().toISOString(),
            ...Object.fromEntries(fd.entries())
        };

        const updatedDB = [...db_content, newEntry];
        if (await saveToGithub(updatedDB)) {
            showToast('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ñ‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ ' + nextId, 'success');
            e.target.reset();
            switchCustomerView('queue');
            refreshData();
        } else {
            showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
        }
        btn.disabled = false;
        btn.innerText = '‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£';
    };

    async function updateStatus(id, newStatus) {
        let updatedDB;
        if (newStatus === 'Delete' || newStatus === 'Done') {
            updatedDB = db_content.filter(i => i.id !== id);
        } else {
            updatedDB = db_content.map(i => {
                if (i.id === id) return { ...i, status: newStatus };
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß‡πÉ‡∏´‡∏°‡πà ‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏ß‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà Serving ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÑ‡∏õ (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏°‡∏µ 1 ‡πÄ‡∏ï‡∏µ‡∏¢‡∏á/‡∏Ñ‡∏ô)
                if (newStatus === 'Serving' && i.status === 'Serving') return null; 
                return i;
            }).filter(Boolean);
        }

        if (await saveToGithub(updatedDB)) {
            showToast('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏¥‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            refreshData();
        }
    }

    // --- NAVIGATION & UI HELPERS ---
    function showPage(page) {
        activePage = page;
        if (page === 'admin') document.getElementById('login-modal').classList.remove('hidden-elm');
        else {
            document.getElementById('page-customer').classList.remove('hidden-elm');
            document.getElementById('page-admin').classList.add('hidden-elm');
            document.getElementById('login-modal').classList.add('hidden-elm');
            toggleNavStyle('customer');
        }
    }

    function checkLogin() {
        if (document.getElementById('admin-pass').value === '1234') {
            document.getElementById('login-modal').classList.add('hidden-elm');
            document.getElementById('page-customer').classList.add('hidden-elm');
            document.getElementById('page-admin').classList.remove('hidden-elm');
            toggleNavStyle('admin');
            renderUI();
        } else {
            showToast('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
        }
    }

    function toggleNavStyle(active) {
        const c = document.getElementById('nav-customer'), a = document.getElementById('nav-admin');
        if (active === 'customer') {
            c.className = 'px-4 py-2 rounded-lg text-sm font-medium bg-purple-600 text-white shadow-lg';
            a.className = 'px-4 py-2 rounded-lg text-sm font-medium text-gray-400';
        } else {
            a.className = 'px-4 py-2 rounded-lg text-sm font-medium bg-purple-600 text-white shadow-lg';
            c.className = 'px-4 py-2 rounded-lg text-sm font-medium text-gray-400';
        }
    }

    function switchCustomerView(view) {
        const f = document.getElementById('customer-form-view'), q = document.getElementById('customer-queue-view');
        const bf = document.getElementById('btn-view-form'), bq = document.getElementById('btn-view-queue');
        if (view === 'form') {
            f.classList.remove('hidden-elm'); q.classList.add('hidden-elm');
            bf.className = 'flex-1 py-3 rounded-2xl font-bold bg-white text-purple-900 shadow-lg scale-105';
            bq.className = 'flex-1 py-3 rounded-2xl font-bold bg-white/10 text-purple-300';
        } else {
            q.classList.remove('hidden-elm'); f.classList.add('hidden-elm');
            bq.className = 'flex-1 py-3 rounded-2xl font-bold bg-white text-purple-900 shadow-lg scale-105';
            bf.className = 'flex-1 py-3 rounded-2xl font-bold bg-white/10 text-purple-300';
            refreshData();
        }
    }

    function switchFormTab(type) {
        document.getElementById('form-order-type').value = type;
        document.getElementById('booking-section').className = type === 'booking' ? 'p-5 rounded-2xl border border-dashed border-purple-500/40 bg-purple-500/5' : 'hidden-elm';
        document.getElementById('tab-walkin').className = type === 'walkin' ? 'flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn active' : 'flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn';
        document.getElementById('tab-booking').className = type === 'booking' ? 'flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn active' : 'flex-1 py-3 rounded-xl font-medium text-sm transition-all tab-btn';
    }

    function showToast(m, t) {
        const c = document.getElementById('toast-container'), el = document.createElement('div');
        el.className = `animate-slide-in px-6 py-3 rounded-xl text-white text-sm shadow-2xl ${t==='success'?'bg-green-600':'bg-red-600'}`;
        el.innerText = m; c.appendChild(el);
        setTimeout(() => el.remove(), 4000);
    }

    function updateStatusIcon(s) {
        const d = document.querySelector('.live-dot'), t = document.querySelector('#live-indicator span');
        if (s==='error') { 
            d.className='w-2 h-2 rounded-full bg-red-500'; 
            t.innerText='Sync Error'; 
            t.className='text-[10px] text-red-400 uppercase tracking-widest'; 
        } else { 
            d.className='w-2 h-2 rounded-full bg-green-500 live-dot'; 
            t.innerText='Live System'; 
            t.className='text-[10px] text-green-400 uppercase tracking-widest'; 
        }
    }
  </script>
 </body>
</html>
